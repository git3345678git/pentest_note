# juicyshop 二星挑戰


```
https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html

docker run --rm -p 3000:3000 bkimminich/juice-shop

192.168.50.237:3000
```




## 進入商店的管理部分

main.js並蒐索 admin

在瀏覽器的開發者工具中開啟main.js並蒐索“admin”。

其中一個匹配項將是映射到 的路由path: "administration"。

main.js 中的管理頁面路由
導覽至http://192.168.50.237:3000/#/administration將出現403 Forbidden錯誤。


假設登入語句:
```
SELECT * FROM users
WHERE username = 'user' AND password = '123'


//1' or 1 --
SELECT * FROM users
WHERE username = '1' or 1 --  ' AND password = '123';


```


會回傳 json 其中關鍵是 email 出現了，而只會回顯一筆，所以估計輸出只會出一筆，所以我們可以加上limit，查看其他資料
```
umail":"admin@juice-sh.op


//1' or 1 limit 1,1--
jim@juice-sh.op

```

登入admin完成挑戰
```
admin@juice-sh.op' -- 


瀏覽
http://192.168.50.237:3000/#/administration
```




## 查看其他用戶的購物籃
以任何使用者登入。

將一些產品放入您的購物籃。

檢查瀏覽器開發人員工具中的會話儲存bid以查找數值。



我加入購物車了Apple Juice (1000ml)


F12 看session storage
```
bid 8
itemTotal 1.99
```


sessionStorage 
```
是 HTML5 提供的一种用于在浏览器会话期间存储数据的机制。与 localStorage 类似，但有一个关键的区别：sessionStorage 存储的数据在会话结束时会被清除，而 localStorage 存储的数据则会持久保存。
```


經過觀察，你的購物籃就會發出以下請求，並查看購物情況。
```
http://192.168.50.237:3000/rest/basket/8
```

怎麼找這個關鍵request 你可以輸入一個特殊值例如:999，然後過濾999會找到
```
http://192.168.50.237:3000/rest/basket/999
```

所以你修改其他值，可以看見別人買了什麼。



## 使用未正確關閉的已棄用的 B2B 介面



檔案上限為100 KB。 
禁止的檔案類型。只允許PDF, ZIP。


main.js，搜尋 pdf 或 zip 找到
```
allowedMimeType: ["application/pdf", "application/xml", "text/xml", "application/zip", "application/x-zip-compressed", "multipart/x-zip"]
```

所以我們猜測 xml，應該也可以上傳， 



## 擺脫所有 5 星級客戶回饋


使用有權限帳號進入
```
http://192.168.50.237:3000/#/administration
```


使用垃圾桶按鈕從客戶回饋表中刪除所有具有五星級評級的條目


##  使用管理員用戶帳號登入


這題，如果你完成上面挑戰，已經成功了
```
或者，如果您在透過 SQL 注入 檢索所有使用者憑證的清單來取得使用者資料後，在彩虹表中 尋找管理員的密碼哈希，則可以使用 電子郵件 admin@juice-sh.op和密碼 登入。admin123 0192023a7bbd73250516f069df18b500
```



## 使用 MC SafeSearch 的原始使用者憑證登入


閱讀此挑戰的提示或谷歌搜尋“MC SafeSearch”最終會讓 您注意到音樂視頻“Protect Ya' Passwordz” 。

觀看此影片可以了解到，MC使用了他的狗的名字“麵條先生”作為密碼，但將“一些元音改為零”。

造訪http://localhost:3000/#/login並使用電子郵件 mc.safesearch@juice-sh.op和密碼 登入Mr. N00dles來解決此挑戰。

mc.safesearch@juice-sh.op

我是用SQL 注入，但失敗。
```
1' or 1  limit 7,1 --
```





## 使用管理員的使用者憑證登錄，無需事先更改它們或套用 SQL 注入

使用電子郵件 admin@juice-sh.op和密碼 登錄admin123








## 在採取行動之前，應像任何“白帽子”一樣行事

請造訪https://securitytxt.org/ 了解允許網站定義安全策略的建議標準。
也就是找到漏洞後，一般公司會有個文件，提供你連絡。


**一般放在以下位置**
```
/.well-known/security.txt
/security.txt
```

**security.txt**
```
http://192.168.50.237:3000/security.txt

Contact: mailto:donotreply@owasp-juice.shop

说明了漏洞报告联系方式，这里是电子邮件地址。
Encryption: https://keybase.io/bkimminich/pgp_keys.asc?fingerprint=19c01cb7157e4645e9e2c863062a85a8cbfbdcda

提供了用于加密通信的公钥的链接。在这个例子中，使用了 Keybase 上的 PGP 公钥。
Acknowledgements: /#/score-board

提供了漏洞报告后的致谢页面的链接。
Preferred-languages: en, ar, az, bg, bn, ca, cs, da, de, ga, el, es, et, fi, fr, ka, he, hi, hu, id, it, ja, ko, lv, my, nl, no, pl, pt, ro, ru, si, sv, th, tr, uk, zh

指定了安全团队首选的报告语言列表。
Hiring: /#/jobs

提供了有关安全团队职位的信息。
Expires: Fri, 17 Jan 2025 03:07:50 GMT

指定了 security.txt 文件的有效期截至日期。
```



## 告知商店有關演算法或庫的信息，它絕對不應該以這種方式使用









## 執行反射型 XSS 攻擊

docker 不支持





## 確定約翰的安全問題的答案
進入照片牆，搜尋用戶已發布的照片j0hNny。

下載那張照片。

檢查照片的元資料。您可以在線上使用各種工具，例如http://exif.regex.info/exif.cgi

查看元資料時，您可以看到照片拍攝位置的座標。座標是36.958717N 84.348217W

在 Google 上搜尋這些座標，找出照片是在哪個森林中拍攝的。可以看出 位於Daniel Boone National Forest這些座標上。

前往登入頁面並點擊忘記密碼？。

填寫john@juice-sh.op電子郵件和Daniel Boone National Forest安全問題的答案。

選擇一個新密碼並點擊“更改”。




## 確定艾瑪的安全問題的答案
進入照片牆，搜尋用戶已發布的照片E=ma²​​。

打開圖像以便可以放大它。

中層最左邊的窗戶上，可以看到一個公司的標誌。可以看出，標誌顯示了名稱ITsec。

前往登入頁面並點擊忘記密碼？。

填寫emma@juice-sh.op電子郵件和ITsec安全問題的答案。

選擇一個新密碼並點擊“更改”。




## 確定艾瑪的安全問題的答案

進入照片牆，搜尋用戶已發布的照片E=ma²​​。

打開圖像以便可以放大它。

中層最左邊的窗戶上，可以看到一個公司的標誌。可以看出，標誌顯示了名稱ITsec。

前往登入頁面並點擊忘記密碼？。

填寫emma@juice-sh.op電子郵件和ITsec安全問題的答案。

選擇一個新密碼並點擊“更改”。



## 使用空白電子郵件和密碼註冊用戶










## 接管包含我們官方 Soul Bound 代幣的錢包
前往“關於我們”部分並檢查評論“請將錢包中的多汁聊天機器人 NFT 發送給我 /juicy-nft”。

在評論「目的背叛婚姻歸因於緊縮監視器旋轉幻燈片捐贈運動舉升離合器」中找到加密錢包的 12 個單字種子短語。

```
purpose betray marriage blame crunch monitor spin slide donate sport lift clutch
```

訪問/juicy-nft果汁店應用程式。

可以看到一個輸入框，輸入錢包的私鑰即可存取NFT。

使用評論中找到的助記詞來派生第一個以太坊錢包的私鑰。您可以造訪https://iancoleman.io/bip39/ 取得相同的資訊。

注意選擇以太坊

在輸入框中輸入導出的私鑰「0x5bcc3e9d38baa06e7bfaab80ae5957bbe8ef059e640311d7d6d465e6bc948e3e」。

