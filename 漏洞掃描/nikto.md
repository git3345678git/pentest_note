# nikto



使用漏洞庫 OSVDB 但已經倒閉了，



## 說明
```
Options:
       -ask+               Whether to ask about submitting updates
                               yes   Ask about each (default)
                               no    Don't ask, don't send
                               auto  Don't ask, just send
       -Cgidirs+           Scan these CGI dirs: "none", "all", or values like "/cgi/ /cgi-a/"
       -config+            Use this config file
       -Display+           Turn on/off display outputs:
                               1     Show redirects
                               2     Show cookies received
                               3     Show all 200/OK responses
                               4     Show URLs which require authentication
                               D     Debug output
                               E     Display all HTTP errors
                               P     Print progress to STDOUT
                               S     Scrub output of IPs and hostnames
                               V     Verbose output
       -dbcheck           Check database and other key files for syntax errors
       -evasion+          Encoding technique:
                               1     Random URI encoding (non-UTF8)
                               2     Directory self-reference (/./)
                               3     Premature URL ending
                               4     Prepend long random string
                               5     Fake parameter
                               6     TAB as request spacer
                               7     Change the case of the URL
                               8     Use Windows directory separator (\)
                               A     Use a carriage return (0x0d) as a request spacer
                               B     Use binary value 0x0b as a request spacer
        -Format+           Save file (-o) format:
                               csv   Comma-separated-value
                               json  JSON Format
                               htm   HTML Format
                               nbe   Nessus NBE format
                               sql   Generic SQL (see docs for schema)
                               txt   Plain text
                               xml   XML Format
                               (if not specified the format will be taken from the file extension passed to -output)
       -Help              Extended help information
       -host+             Target host/URL
       -404code           Ignore these HTTP codes as negative responses (always). Format is "302,301".
       -404string         Ignore this string in response body content as negative response (always). Can be a regular expression.
       -id+               Host authentication to use, format is id:pass or id:pass:realm
       -key+              Client certificate key file
       -list-plugins      List all available plugins, perform no testing
       -maxtime+          Maximum testing time per host (e.g., 1h, 60m, 3600s)
       -mutate+           Guess additional file names:
                               1     Test all files with all root directories
                               2     Guess for password file names
                               3     Enumerate user names via Apache (/~user type requests)
                               4     Enumerate user names via cgiwrap (/cgi-bin/cgiwrap/~user type requests)
                               5     Attempt to brute force sub-domain names, assume that the host name is the parent domain
                               6     Attempt to guess directory names from the supplied dictionary file
       -mutate-options    Provide information for mutates
       -nointeractive     Disables interactive features
       -nolookup          Disables DNS lookups
       -nossl             Disables the use of SSL
       -no404             Disables nikto attempting to guess a 404 page
       -Option            Over-ride an option in nikto.conf, can be issued multiple times
       -output+           Write output to this file ('.' for auto-name)
       -Pause+            Pause between tests (seconds, integer or float)
       -Plugins+          List of plugins to run (default: ALL)
       -port+             Port to use (default 80)
       -RSAcert+          Client certificate file
       -root+             Prepend root value to all requests, format is /directory
       -Save              Save positive responses to this directory ('.' for auto-name)
       -ssl               Force ssl mode on port
       -Tuning+           Scan tuning:
                               1     Interesting File / Seen in logs
                               2     Misconfiguration / Default File
                               3     Information Disclosure
                               4     Injection (XSS/Script/HTML)
                               5     Remote File Retrieval - Inside Web Root
                               6     Denial of Service
                               7     Remote File Retrieval - Server Wide
                               8     Command Execution / Remote Shell
                               9     SQL Injection
                               0     File Upload
                               a     Authentication Bypass
                               b     Software Identification
                               c     Remote Source Inclusion
                               d     WebService
                               e     Administrative Console
                               x     Reverse Tuning Options (i.e., include all except specified)
       -timeout+          Timeout for requests (default 10 seconds)
       -Userdbs           Load only user databases, not the standard databases
                               all   Disable standard dbs and load only user dbs
                               tests Disable only db_tests and load udb_tests
       -useragent         Over-rides the default useragent
       -until             Run until the specified time or duration
       -update            Update databases and plugins from CIRT.net
       -url+              Target host/URL (alias of -host)
       -useproxy          Use the proxy defined in nikto.conf, or argument http://server:port
       -Version           Print plugin and database versions
       -vhost+            Virtual host (for Host header)
                + requires a value



这里是参数列表的翻译：

- `-config+`：使用此配置文件。
- `-Display+`：打开/关闭显示输出。
- `-dbcheck`：检查数据库和其他关键文件的语法错误。
- `-Format+`：保存文件的格式（-o 参数的格式）。
- `-Help`：获取扩展帮助信息。
- `-host+`：目标主机/URL。
- `-id+`：使用的主机身份验证，格式为 id:pass 或 id:pass:realm。
- `-list-plugins`：列出所有可用的插件。
- `-output+`：将输出写入此文件。
- `-nossl`：禁用 SSL。
- `-no404`：禁用 404 检查。
- `-Plugins+`：要运行的插件列表（默认为 ALL）。
- `-port+`：要使用的端口（默认为 80）。
- `-root+`：将根值添加到所有请求之前，格式为 /directory。
- `-ssl`：在端口上强制 SSL 模式。
- `-Tuning+`：扫描调整。
- `-timeout+`：请求的超时时间（默认为 10 秒）。
- `-update`：从 CIRT.net 更新数据库和插件。
- `-Version`：打印插件和数据库版本。
- `-vhost+`：虚拟主机（用于 Host 标头）。'+ 需要一个值。


```


```
# 一般
./nikto.pl -host http://pika


# 扫描https网站
./nikto.pl -host www.baidu.com -ssl -port 443


./nikto.pl -host http://192.168.31.134 -o 2.html -F htm

# 修改配置信息
user-agent
COOKIE 
./nikto.pl -config xxx

```




```
这是 Nikto 2.5.0 的扫描结果摘要，让我帮你解释一下：

- **目标信息**:
  - 目标 IP 地址: 192.168.50.46
  - 目标主机名: pika
  - 目标端口: 80
  - 开始时间: 2024-04-25 01:21:34 (GMT-4)

- **服务器信息**:
  - 服务器: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02
  - Cookie PHPSESSID 创建时未设置 httponly 标志
  - 获取到的 x-powered-by 头部信息: PHP/7.3.4
  - 未设置反点击劫持 X-Frame-Options 头部
  - 未定义 X-XSS-Protection 头部。该头部可提示用户代理程序防范某些形式的跨站脚本攻击
  - 未设置 X-Content-Type-Options 头部。这可能允许用户代理程序以不同的方式呈现站点内容以匹配 MIME 类型
  - OSVDB-3268: / 目录存在索引
  - Web 服务器使用无效的 HTTP 方法返回有效响应，这可能会导致误报
  - OSVDB-877: HTTP TRACE 方法激活，表明主机可能易受 XST 攻击
  - OSVDB-6694: /.DS_Store: 在 Mac OSX 上，Apache 会提供 .DS_Store 文件，其中包含敏感信息。配置 Apache 忽略此文件或升级到较新版本
  - OSVDB-3092: /install.php: 发现 install.php 文件
  - OSVDB-3092: /test.php: 这可能是有趣的...
  
- **扫描统计信息**:
  - 扫描了 1 个主机
  - 8490 个请求
  - 0 个错误
  - 11 个问题报告

- **结束时间**:
  - 结束时间: 2024-04-25 01:22:39 (GMT-4)（共耗时 65 秒）

这些信息可以帮助识别潜在的安全问题和配置错误，以便采取适当的措施加强系统安全。
```





## IDS 躲避
nikto 在扫描过程中也可以使用它自带的 ids 躲避规则，参数是 - evasion，nikto 提供了八种躲避规则，通过 man 手册可查看详细信息

```
nikto -host http://pika -evasion 123456


vasion+          Encoding technique:
                               1     Random URI encoding (non-UTF8)
                               2     Directory self-reference (/./)
                               3     Premature URL ending
                               4     Prepend long random string
                               5     Fake parameter
                               6     TAB as request spacer
                               7     Change the case of the URL
                               8     Use Windows directory separator (\)
                               A     Use a carriage return (0x0d) as a request spacer
                               B     Use binary value 0x0b as a request spacer
```





## 可以使用目錄，但不能使用檔案

例如
```
http://pika/vul/xss/123.php
```

原因:

他的payload 都是根據某個特定的漏洞去直接打，所以是很死的。
我比較需要的是針對特定的參數。

他比較像在檢測知名的漏洞，也不看是怎樣的服務就一亂打，有中就代表可能是屬於哪個漏洞。
```
V:Thu Apr 25 04:05:39 2024 - 404 for GET:       /vul/sqli/index.php?offset=[%20Problem%20Here%20]
V:Thu Apr 25 04:05:39 2024 - 404 for GET:       /vul/sqli/utils/sprc.asp
V:Thu Apr 25 04:05:39 2024 - 404 for GET:       /vul/sqli/db.php?q='&t='
V:Thu Apr 25 04:05:39 2024 - 404 for GET:       /vul/sqli/rpc.php?q='&t='
V:Thu Apr 25 04:05:39 2024 - 404 for POST:      /vul/sqli/search.php
V:Thu Apr 25 04:05:39 2024 - 404 for POST:      /vul/sqli/private.php
V:Thu Apr 25 04:05:39 2024 - 404 for GET:       /vul/sqli/CHANGELOG.txt

```


可以直接加上目錄路徑。
```
./nikto.pl  -h "http://pika/vul/xss/"  -Tuning 4   -Display V


./nikto.pl  -h "http://pika/vul/sqli/"  -Tuning 9   -Display 3
```



## 心得
比較像是亂打一堆知名CMS 框架 服務的 payload，不是屬於特定的模糊測試。
不過也可以做為一種簡單的掃描。
他針對一些標頭的檢測或是敏感文件也還可以。
