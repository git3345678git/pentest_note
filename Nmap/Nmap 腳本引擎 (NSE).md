# Nmap 腳本引擎 (NSE)



## 兩種方式查看腳本
### 線上看
```
分類
https://nmap.org/nsedoc/categories/

auth
broadcast
brute
default
discovery
dos
exploit
external
fuzzer
intrusive
malware
safe
version
vuln



全部
https://nmap.org/nsedoc/scripts/
```

### 手動
```
cat /usr/share/nmap/scripts/script.db

# 關鍵字
grep "ftp" /usr/share/nmap/scripts/script.db

#搜尋分類
grep "brute" /usr/share/nmap/scripts/script.db
```






```
SCRIPT SCAN:
  -sC: equivalent to --script=default
  --script=<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
  --script-args=<n1=v1,[n2=v2,...]>: provide arguments to scripts
  --script-args-file=filename: provide NSE script args in a file
  --script-trace: Show all data sent and received
  --script-updatedb: Update the script database.
  --script-help=<Lua scripts>: Show help about scripts.
           <Lua scripts> is a comma-separated list of script-files or
           script-categories.
           
---------------------------------------------------------------------------        
-sC 選項等效於 --script=default，它會執行默認的 NSE（Nmap 腳本引擎）腳本。
--script=<Lua scripts> 選項允許你指定要運行的腳本，可以是目錄、腳本文件或腳本類別，多個之間用逗號分隔。
--script-args=<n1=v1,[n2=v2,...]> 選項用於提供給腳本的參數，多個參數之間用逗號分隔，形式為 name=value。


--script-args-file=filename 選項用於從文件中提供 NSE 腳本的參數。
--script-trace 選項用於顯示所有發送和接收的數據，用於調試目的。
--script-updatedb 選項用於更新腳本數據庫。
--script-help=<Lua scripts> 選項用於顯示關於指定腳本的幫助信息，可以是腳本文件或腳本類別，多個之間用逗號分隔。
           
```


## 有些安全的類別，或簡單無害的腳本使用方法為預設，有些需要參數，總之很複雜
```
ftp-anon
address-info
nmap -sV -sC 192.168.50.1
    


nmap --script ftp-brute -p 21 192.168.50.46


nmap -sV --script=http-php-version 192.168.50.46


nmap -sn dmoe.in --script whois-ip
    
    
nmap --script vmware-version -p80 192.168.50.237
```


## 心得


我不確定好不好用，我覺得很多都很舊，但萬一有需要檢測，這裡可以看看。web http類的 教給專業的可能好一點，這裡查看似乎沒有效率。就做為一個庫吧