# xnLinkFinder

說明
```
usage: xnLinkFinder [-h] [-i INPUT] [-o OUTPUT] [-op OUTPUT_PARAMS] [-owl OUTPUT_WORDLIST] [-oo OUTPUT_OOS] [-ow]
                    [-sp <domain/file>] [-spo] [-spkf] [-sf <domain/file>] [-c COOKIES] [-H HEADERS]
                    [-ra REGEX_AFTER] [-d DEPTH] [-p <integer>] [-x EXCLUDE] [-orig] [-prefixed] [-xrel]
                    [-t <seconds>] [-inc] [-u [...]] [-insecure] [-s429] [-s403] [-sTO] [-sCE] [-m <integer>]
                    [-mfs <integer>] [-rp REPLAY_PROXY] [-ascii-only] [-mtl <integer>] [--config CONFIG] [-nwlpl]
                    [-nwlpw] [-nwlpm] [-nwlc] [-nwlia] [-nwld] [-nwll] [-wlml WORDLIST_MAXLEN]
                    [-swf STOPWORDS_FILE] [-brt <bool>] [-nb] [-v] [-vv] [--version]

xnlLinkFinder (v6.0) - by @Xnl-h4ck3r

options:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        Input a: URL, text file of URLs, a Directory of files to search, a Burp XML output file or
                        an OWASP ZAP output file.
  -o OUTPUT, --output OUTPUT
                        The file to save the Links output to, including path if necessary (default: output.txt). If
                        set to "cli" then output is only written to STDOUT. If the file already exist it will just
                        be appended to (and de-duplicated) unless option -ow is passed.
  -op OUTPUT_PARAMS, --output-params OUTPUT_PARAMS
                        The file to save the Potential Parameters output to, including path if necessary (default:
                        parameters.txt). If set to "cli" then output is only written to STDOUT (but not piped to
                        another program). If the file already exist it will just be appended to (and de-duplicated)
                        unless option -ow is passed.
  -owl OUTPUT_WORDLIST, --output-wordlist OUTPUT_WORDLIST
                        The file to save the target specific Wordlist output to, including path if necessary
                        (default: No wordlist output). If set to "cli" then output is only written to STDOUT (but
                        not piped to another program). If the file already exist it will just be appended to (and
                        de-duplicated) unless option -ow is passed.
  -oo OUTPUT_OOS, --output-oos OUTPUT_OOS
                        The file to save Out Of Scope links to, including path if necessary (default: No OOS
                        output). If set to "cli" then output is only written to STDOUT (but not piped to another
                        program). If the file already exist it will just be appended to (and de-duplicated) unless
                        option -ow is passed.
  -ow, --output-overwrite
                        If the output file already exists, it will be overwritten instead of being appended to.
  -sp <domain/file>, --scope-prefix <domain/file>
                        Any links found starting with / will be prefixed with scope domains in the output instead
                        of the original link. If the passed value is a valid file name, that file will be used,
                        otherwise the string literal will be used.
  -spo, --scope-prefix-original
                        If argument -sp is passed, then this determines whether the original link starting with /
                        is also included in the output (default: false).
  -spkf, --scope-prefix-keep-failed
                        If argument -spkf is passed, then this determines whether a prefixed link will be kept in
                        the output if it was a 404 or a RequestException occurred (default: false).
  -sf <domain/file>, --scope-filter <domain/file>
                        Will filter output links to only include them if the domain of the link is in the scope
                        specified. If the passed value is a valid file name, that file will be used, otherwise the
                        string literal will be used. This argument is now mandatory if input is a domain/URL (or
                        file of domains/URLs) to prevent crawling sites that are not in scope and also preventing
                        misleading results.
  -c COOKIES, --cookies COOKIES
                        Add cookies to pass with HTTP requests. Pass in the format 'name1=value1; name2=value2;'
  -H HEADERS, --headers HEADERS
                        Add custom headers to pass with HTTP requests. Pass in the format 'Header1: value1;
                        Header2: value2;'
  -ra REGEX_AFTER, --regex-after REGEX_AFTER
                        RegEx for filtering purposes against found endpoints before output (e.g.
                        /api/v[0-9]\.[0-9]* ). If it matches, the link is output.
  -d DEPTH, --depth DEPTH
                        The level of depth to search. For example, if a value of 2 is passed, then all links
                        initially found will then be searched for more links (default: 1). This option is ignored
                        for Burp files, ZAP files and Caiod files because they can be huge and consume lots of
                        memory. It is also advisable to use the -sp (--scope-prefix) argument to ensure a request
                        to links found without a domain can be attempted.
  -p <integer>, --processes <integer>
                        Basic multithreading is done when getting requests for a URL, or file of URLs (not a Burp
                        file, ZAP file or Caido file). This argument determines the number of processes (threads)
                        used (default: 25)
  -x EXCLUDE, --exclude EXCLUDE
                        Additional Link exclusions (to the list in config.yml) in a comma separated list, e.g.
                        careers,forum
  -orig, --origin       Whether you want the origin of the link to be in the output. Displayed as LINK-URL [ORIGIN-
                        URL] in the output (default: false)
  -prefixed             Whether you want to see which links were prefixed in the output. Displays (PREFIXED) after
                        link and origin in the output (default: false)
  -xrel, --exclude-relative-links
                        By default, if any links in the results start with `./` or `../`, they will be included. If
                        this argument is used, these relative links will not be added.
  -t <seconds>, --timeout <seconds>
                        How many seconds to wait for the server to send data before giving up (default: 10 seconds)
  -inc, --include       Include input (-i) links in the output (default: false)
  -u [ ...], --user-agent [ ...]
                        What User Agents to get links for, e.g. '-u desktop mobile'
  -insecure             Whether TLS certificate checks should be made disabled making requests (default: false)
  -s429                 Stop when > 95 percent of responses return 429 Too Many Requests (default: false)
  -s403                 Stop when > 95 percent of responses return 403 Forbidden (default: false)
  -sTO                  Stop when > 95 percent of requests time out (default: false)
  -sCE                  Stop when > 95 percent of requests have connection errors (default: false)
  -m <integer>, --memory-threshold <integer>
                        The memory threshold percentage. If the machines memory goes above the threshold, the
                        program will be stopped and ended gracefully before running out of memory (default: 95)
  -mfs <integer>, --max-file-size <integer>
                        The maximum file size (in bytes) of a file to be checked if -i is a directory. If the file
                        size os over, it will be ignored (default: 500 MB). Setting to 0 means no files will be
                        ignored, regardless of size.
  -rp REPLAY_PROXY, --replay-proxy REPLAY_PROXY
                        For active link finding with URL (or file of URLs), replay the requests through this proxy.
  -ascii-only           Whether links and parameters will only be added if they only contain ASCII characters
                        (default: False). This can be useful when you know the target is likely to use ASCII
                        characters and you also get a number of false positives from binary files for some reason.
  -mtl <integer>, --max-time-limit <integer>
                        The maximum time limit (in minutes) to run before stopping (default: 0). If 0 is passed,
                        there is no limit.
  --config CONFIG       Path to the YML config file. If not passed, it looks for file 'config.yml' in the same
                        directory as runtime file 'xnLinkFinder.py'.
  -nwlpl, --no-wordlist-plurals
                        When words are found for a target specific wordlist, by default new words are added if
                        there is a singular word from a plural, and vice versa. If this argument is used, this
                        process is not done.
  -nwlpw, --no-wordlist-pathwords
                        By default, any path words found in the links will be processed for the target specific
                        wordlist. If this argument is used, they will not be processed.
  -nwlpm, --no-wordlist-parameters
                        By default, any parameters found in the links will be processed for the target specific
                        wordlist. If this argument is used, they will not be processed.
  -nwlc, --no-wordlist-comments
                        By default, any comments in pages will be processed for the target specific wordlist. If
                        this argument is used, they will not be processed.
  -nwlia, --no-wordlist-imgalt
                        By default, any image 'alt' attributes will be processed for the target specific wordlist.
                        If this argument is used, they will not be processed.
  -nwld, --no-wordlist-digits
                        Exclude any words from the target specific wordlist with numerical digits in.
  -nwll, --no-wordlist-lowercase
                        By default, any word added with any uppercase characters in will also add the word in
                        lowercase. If this argument is used, the lowercase words will not be added.
  -wlml WORDLIST_MAXLEN, --wordlist-maxlen WORDLIST_MAXLEN
                        The maximum length of words to add to the target specific wordlist (excluding plurals).
  -swf STOPWORDS_FILE, --stopwords-file STOPWORDS_FILE
                        A file of additional Stop Words (in addition to "stopWords" in the YML Config file) used to
                        exclude words from the target specific wordlist. Stop Words are used in Natural Language
                        Processing and different lists can be found in different libraries. You may want to add
                        words in different languages, depending on your target.
  -brt <bool>, --burpfile-remove-tags <bool>
                        Whether to remove tags if a Burp file is passed as input. This is asked interactively if
                        the flag is not passed. Pass as True or False. If this argument is not passed then the
                        question will be asked interactively.
  -nb, --no-banner      Hides the tool banner.
  -v, --verbose         Verbose output
  -vv, --vverbose       Increased verbose output
  --version             Show version number


-----------------------------------------------------------
```







## 目前會用的方法
```
#  找到所有相對目錄
 xnLinkFinder -i http://dvwa.com/vulnerabilities/brute/   -sf dvwa.*   -d 1  -ow -c 'PHPSESSID=eol8rs09pq8onksc6157n9on0d; security=impossible' -v


../../vulnerabilities/brute/
../../vulnerabilities/sqli_blind/
../../vulnerabilities/view_source.php?id=brute&security=impossible
../../vulnerabilities/fi/.?page=include.php
../../instructions.php
../../vulnerabilities/upload/
../../vulnerabilities/open_redirect/
../../vulnerabilities/xss_r/
../../vulnerabilities/authbypass/
../../vulnerabilities/csp/
../../vulnerabilities/weak_id/
../../vulnerabilities/xss_s/
../../setup.php
../../logout.php
../../security.php
../../vulnerabilities/sqli/
../../vulnerabilities/view_help.php?id=brute&security=impossible&locale=en
../../vulnerabilities/exec/
../../vulnerabilities/javascript/
../../phpinfo.php
../../dvwa/js/dvwaPage.js
../../vulnerabilities/xss_d/
../../about.php
../../vulnerabilities/csrf/
../../dvwa/js/add_event_listeners.js










# 深入2層，所以需要完整URL， -sp http://dvwa.com

 xnLinkFinder -i http://dvwa.com/vulnerabilities/brute/   -sf dvwa.*  -sp http://dvwa.com -d 2  -ow -c 'PHPSESSID=eol8rs09pq8onksc6157n9on0d; security=impossible' -v



http://dvwa.com/../../vulnerabilities/view_help.php?id=javascript&security=impossible&locale=en
http://dvwa.com/../../vulnerabilities/exec/
http://dvwa.com/../../vulnerabilities/xss_r/
http://dvwa.com/../../vulnerabilities/view_help.php?id=exec&security=impossible&locale=en
http://dvwa.com/../../vulnerabilities/view_source.php?id=exec&security=impossible
http://dvwa.com/../../dvwa/js/dvwaPage.js
http://dvwa.com/../../phpinfo.php
http://dvwa.com/../../vulnerabilities/fi/.?page=include.php
http://dvwa.com/../../logout.php
http://dvwa.com/../../vulnerabilities/weak_id/
http://dvwa.com/../../vulnerabilities/view_help.php?id=brute&security=impossible&locale=en
http://dvwa.com/../../about.php
http://dvwa.com/../../vulnerabilities/csrf/
http://dvwa.com/../../vulnerabilities/view_help.php?id=xss_r&security=impossible&locale=en
http://dvwa.com/../../vulnerabilities/brute/
http://dvwa.com/../../vulnerabilities/xss_s/
http://dvwa.com/../../vulnerabilities/sqli_blind/
http://dvwa.com/../../security.php
http://dvwa.com/../../vulnerabilities/view_source.php?id=brute&security=impossible
http://dvwa.com/../../vulnerabilities/javascript/
http://dvwa.com/../../instructions.php
http://dvwa.com/../../dvwa/js/add_event_listeners.js
http://dvwa.com/./compose.yml
http://dvwa.com/../../vulnerabilities/view_source.php?id=javascript&security=impossible
http://dvwa.com/../../vulnerabilities/open_redirect/
http://dvwa.com/../../vulnerabilities/xss_d/
http://dvwa.com/phpinfo.php
http://dvwa.com/../../setup.php
http://dvwa.com/../../vulnerabilities/sqli/
http://dvwa.com/../../vulnerabilities/csp/
http://dvwa.com/../../vulnerabilities/view_source.php?id=xss_r&security=impossible
http://dvwa.com/../../vulnerabilities/upload/
http://dvwa.com/../../vulnerabilities/authbypass/








# -sp 可以更改找到的域名，這對於使用https http 或是 針對已知子域名，旁站，有可能有用

 xnLinkFinder -i http://dvwa.com/vulnerabilities/brute/   -sf dvwa.*  -sp http://dvwa123.com -d 1  -ow -c 'PHPSESSID=eol8rs09pq8onksc6157n9on0d; security=impossible' -v



http://dvwa123.com/../../about.php
http://dvwa123.com/../../instructions.php
http://dvwa123.com/../../vulnerabilities/xss_d/
http://dvwa123.com/../../vulnerabilities/view_help.php?id=brute&security=impossible&locale=en
http://dvwa123.com/../../vulnerabilities/xss_r/
http://dvwa123.com/../../setup.php
http://dvwa123.com/../../vulnerabilities/csp/
http://dvwa123.com/../../vulnerabilities/exec/
http://dvwa123.com/../../vulnerabilities/sqli_blind/
http://dvwa123.com/../../vulnerabilities/view_source.php?id=brute&security=impossible
http://dvwa123.com/../../vulnerabilities/open_redirect/
http://dvwa123.com/../../logout.php
http://dvwa123.com/../../vulnerabilities/upload/
http://dvwa123.com/../../vulnerabilities/xss_s/
http://dvwa123.com/../../dvwa/js/dvwaPage.js
http://dvwa123.com/../../vulnerabilities/javascript/
http://dvwa123.com/../../dvwa/js/add_event_listeners.js
http://dvwa123.com/../../vulnerabilities/authbypass/
http://dvwa123.com/../../vulnerabilities/brute/
http://dvwa123.com/../../vulnerabilities/sqli/
http://dvwa123.com/../../vulnerabilities/weak_id/
http://dvwa123.com/../../phpinfo.php
http://dvwa123.com/../../vulnerabilities/csrf/
http://dvwa123.com/../../vulnerabilities/fi/.?page=include.php
http://dvwa123.com/../../security.php

```












## 使用心得

很複雜不易使用，我沒上手，感覺有bug，但他自定義高，並且可以修改header ，這是其他工具沒有的。
其他工具若是遇到此類的情況，可能要用BP攔截在加上header
```
Authorization: Bearer XXXXXXXXXXXXXX
```

我嚴重懷疑，他是抓取靜態網頁，而且沒有follow跳轉，所以這工具有點不實用。
