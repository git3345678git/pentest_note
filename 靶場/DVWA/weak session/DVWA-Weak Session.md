# DVWA-Weak Session



# low 

這題沒啥好說的就是cookie

```
POST /vulnerabilities/weak_id/ HTTP/1.1
Host: dvwa.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
Origin: http://dvwa.com
Connection: close
Referer: http://dvwa.com/vulnerabilities/weak_id/
Cookie: dvwaSession=1; PHPSESSID=8jgj4upsi6j7ch806asd2jvrl6; security=low
Upgrade-Insecure-Requests: 1
```

每請求一次 dvwaSession +1


如果掌握了規律，就能登入別人帳號。






# medium 

請求
```
dvwaSession = 
1710507580
1710507607
1710507648
```

一樣有規律，可以爆破。


而且其實是unix time stamp 
```
Fri Mar 15 2024 21:00:07 GMT+0800
```



# high



請求3次，一看就知道md5
```
c4ca4238a0b923820dcc509a6f75849b

c81e728d9d4c2f636f067f89cc14862c

eccbc87e4b5ce2fe28308fd9f2a7baf3
```

crack online
https://hashes.com/en/tools/hash_identifier
```
c4ca4238a0b923820dcc509a6f75849b:31
c81e728d9d4c2f636f067f89cc14862c:2
eccbc87e4b5ce2fe28308fd9f2a7baf3:3
```















# impossible


sha1(隨機數+ 時間 +Impossible字串) 基本上無解

```
$html = "";

if ($_SERVER['REQUEST_METHOD'] == "POST") {
    $cookie_value = sha1(mt_rand() . time() . "Impossible");
    setcookie("dvwaSession", $cookie_value, time()+3600, "/vulnerabilities/weak_id/", $_SERVER['HTTP_HOST'], true, true);
} 
```