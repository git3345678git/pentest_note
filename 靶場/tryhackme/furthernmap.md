# furthernmap

**選項**

```
-Pn
用于禁用主机发现（host discovery）。通常情况下，Nmap 在扫描之前会使用 ICMP、TCP 或者 ARP 等方式进行主机发现，以确定哪些主机是活动的。然而，当目标主机对这些探测进行过滤或阻止时，使用 -Pn 可以跳过主机发现步骤，强制Nmap假设目标主机是活动的，直接进行端口扫描。


-sn：
此選項指定 Ping 掃描。它禁用端口掃描，僅執行主機發現（Ping 掃描）。它向目標 IP 地址發送 ICMP Echo 請求（ping）以檢查主機是否正常運行。

-sS: 
TCP SYN 掃描
通過發送 SYN 封包並等待響應來初始化一個 TCP 連接，以確定端口的狀態。

-sU: UDP 掃描
掃描目標系統上的開放 UDP 端口。

-O: 操作系統檢測
通過分析網絡響應模式來嘗試確定目標運行的操作系統。

-sV: 服務版本檢測
嘗試確定開放端口上運行的服務的版本。

-v: 詳細輸出
增加輸出的詳細程度，提供有關掃描的更多細節。

-vv: 非常詳細輸出
提供比單一 -v 選項更詳細的輸出。

-oA: 輸出到所有格式
將掃描結果保存為所有格式（普通、XML 和可搜索格式）的獨立文件。

-oN: 普通輸出
將正常輸出保存到指定文件中。

-oG: 可搜索輸出
將輸出保存為可輕松由 grep 等工具解析的格式。

-A: 侵略性掃描
啟用一些高級選項，包括操作系統檢測、版本檢測、腳本掃描和路由追踪。

-T5: 時間模板（侵略性）
將時間模板設置為最侵略性的水平，以實現更快的掃描，但可能更容易被檢測到。

-p 80: 指定端口號
掃描指定的端口（在這種情況下，端口 80）。

-p 1000-1500: 指定端口範圍
掃描指定範圍內的端口（從 1000 到 1500）。

-p-: 掃描所有 65535 個端口
掃描所有從 1 到 65535 的端口。

--script: 執行 Nmap 腳本
運行針對目標的特定腳本。

--script=vuln: 執行特定的漏洞腳本
運行一個專注於識別目標漏洞的腳本。
```




**接埠掃描時，有三種基本掃描類型**


```
TCP連線掃描 (-sT )
SYN「半開」掃描 ( -sS)
UDP掃描 (-sU )
```


**此外，還有幾種不太常見的連接埠掃描類型
它們比 SYN「隱形」掃描更隱密**

```
TCP空掃描 (-sN )
TCP FIN 掃描 (-sF )
TCP聖誕節掃描 (-sX )
```



**NSE 腳本類別**

```
safe:- 不會影響目標
intrusive：- 不安全：可能會影響目標
vuln:- 掃描漏洞
exploit:- 嘗試利用漏洞
auth:- 嘗試繞過正在執行的服務的身份驗證（例如匿名登入FTP伺服器）
brute:- 嘗試暴力破解運行服務的憑證
discovery:- 嘗試查詢正在執行的服務以取得有關網路的更多資訊（例如查詢 SNMP 伺服器）。
```


**有兩種方法可以搜尋已安裝的腳本**

```
cat /usr/share/nmap/scripts/script.db
grep "ftp" /usr/share/nmap/scripts/script.db
grep "safe" /usr/share/nmap/scripts/script.db



ls /usr/share/nmap/scripts/
ls -l /usr/share/nmap/scripts/*ftp*

```


**查看腳本 info，然後他會給官方Link，你可以查看使用說明。**

官方查看
```
https://nmap.org/nsedoc/scripts/
```

```
nmap --script-help smb-vuln-ms17-010.nse

smb-vuln-ms17-010
Categories: vuln safe
https://nmap.org/nsedoc/scripts/smb-vuln-ms17-010.html
  Attempts to detect if a Microsoft SMBv1 server is vulnerable to a remote code
   execution vulnerability (ms17-010, a.k.a. EternalBlue).
   The vulnerability is actively exploited by WannaCry and Petya ransomware and other malware.

  The script connects to the $IPC tree, executes a transaction on FID 0 and
   checks if the error "STATUS_INSUFF_SERVER_RESOURCES" is returned to
   determine if the target is not patched against ms17-010. Additionally it checks
   for known error codes returned by patched systems.

  Tested on Windows XP, 2003, 7, 8, 8.1, 10, 2008, 2012 and 2016.


--------------------------------------------------------------------


nmap --script-help http-put.nse

http-put
Categories: discovery intrusive
https://nmap.org/nsedoc/scripts/http-put.html
  Uploads a local file to a remote web server using the HTTP PUT method. You must specify the filename and URL path with NSE arguments.






```


**如果執行該命令，則將針對目標執行任何適用的安全腳本**
```
--script=vuln --script=safe
```

**要運行特定腳本**
```
--script=http-fileupload-exploiter
```



**某些腳本需要參數（例如，憑證，如果它們正在利用經過身份驗證的漏洞）。這些可以透過Nmap開關給出。腳本就是一個例子（用於使用 PUT 方法上傳檔案）。這需要兩個參數：將檔案上傳到的 URL 以及檔案在磁碟上的位置。例如：--script-args http-put**

```
nmap -p 80 --script http-put --script-args http-put.url='/dav/shell.php',http-put.file='./shell.php' 



nmap -p445 --script smb-vuln-ms17-010 192.168.50.46
```


**防火牆/IDS 規避欺騙**

官方其他方式
```
https://nmap.org/book/man-bypass-firewalls-ids.html
```

**基本使用**
```
碎片化扫描 (-f):
sudo nmap -f 192.168.50.46
这会对目标 IP 进行碎片化扫描，将TCP数据包分割成小片段，以绕过一些网络设备的检测。



设置最大传输单元 (--mtu):
sudo nmap --mtu 16 192.168.50.46
這必須是 8 的倍數。




设置扫描延迟 (--scan-delay):
sudo nmap --scan-delay 50ms 192.168.50.46
这个例子设置了两个扫描之间的延迟为50ms，有助于减轻对目标系统的影响。

用於在發送的資料包之間添加延遲。如果網路不穩定，這非常有用，而且還可以逃避任何可能存在的基於時間的防火牆/IDS 觸發器。



强制生成错误的校验和 (--badsum):
sudo nmap --badsum 192.168.50.46
这个例子会使Nmap故意生成错误的校验和，用于测试设备或网络对错误检测的响应。

這用於產生資料包的無效校驗和。任何真正的 TCP/IP 堆疊都會丟棄此封包，但是，防火牆可能會自動回應，而無需檢查封包的校驗和。因此，此開關可用於確定防火牆/IDS 的存在。

```






